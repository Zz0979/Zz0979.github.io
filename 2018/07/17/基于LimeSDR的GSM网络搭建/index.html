<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="这篇是记录怎么搭建简易GSM基站的，过程很复杂。搞了很长时间，现在慢慢整理一下。理一下思路。 首先是看到这个http://osmocom.org/projects/osmobts/wiki/Wiki 准备因为驱动的复杂性，必须从零开始。准备一个xubuntu16.04的全新虚拟机。理论上的安装顺序是（UHD，SoapySDR,SoapyUHD,LimeSuite)但是我不是这样装的，等会儿会提到。">
<meta property="og:type" content="article">
<meta property="og:title" content="基于LimeSDR的GSM网络搭建">
<meta property="og:url" content="http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/index.html">
<meta property="og:site_name" content="jsmhny&#39;s Blog">
<meta property="og:description" content="这篇是记录怎么搭建简易GSM基站的，过程很复杂。搞了很长时间，现在慢慢整理一下。理一下思路。 首先是看到这个http://osmocom.org/projects/osmobts/wiki/Wiki 准备因为驱动的复杂性，必须从零开始。准备一个xubuntu16.04的全新虚拟机。理论上的安装顺序是（UHD，SoapySDR,SoapyUHD,LimeSuite)但是我不是这样装的，等会儿会提到。">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-07-17T12:48:34.580Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于LimeSDR的GSM网络搭建">
<meta name="twitter:description" content="这篇是记录怎么搭建简易GSM基站的，过程很复杂。搞了很长时间，现在慢慢整理一下。理一下思路。 首先是看到这个http://osmocom.org/projects/osmobts/wiki/Wiki 准备因为驱动的复杂性，必须从零开始。准备一个xubuntu16.04的全新虚拟机。理论上的安装顺序是（UHD，SoapySDR,SoapyUHD,LimeSuite)但是我不是这样装的，等会儿会提到。">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>基于LimeSDR的GSM网络搭建</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/10/23/SQLi-lab/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/07/12/探究rand/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&text=基于LimeSDR的GSM网络搭建"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&is_video=false&description=基于LimeSDR的GSM网络搭建"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=基于LimeSDR的GSM网络搭建&body=Check out this article: http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&name=基于LimeSDR的GSM网络搭建&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#准备"><span class="toc-number">1.</span> <span class="toc-text">准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LimeSuite-UHD-SoapyUHD-依赖"><span class="toc-number">2.0.1.</span> <span class="toc-text">LimeSuite UHD SoapyUHD 依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-LimeSuite"><span class="toc-number">2.0.2.</span> <span class="toc-text">Install LimeSuite</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-UHD"><span class="toc-number">2.0.3.</span> <span class="toc-text">Install UHD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-SoapySDR-and-SoapyUHD"><span class="toc-number">2.0.4.</span> <span class="toc-text">Install SoapySDR and SoapyUHD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-libosmocore"><span class="toc-number">2.0.5.</span> <span class="toc-text">Install libosmocore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-osmo-trx"><span class="toc-number">2.0.6.</span> <span class="toc-text">Install osmo-trx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-osmo-nitb"><span class="toc-number">2.0.7.</span> <span class="toc-text">Install osmo-nitb</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBTS"><span class="toc-number">3.</span> <span class="toc-text">OpenBTS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装OpenBTS"><span class="toc-number">3.0.1.</span> <span class="toc-text">安装OpenBTS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#启动"><span class="toc-number">3.0.2.</span> <span class="toc-text">启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBSC"><span class="toc-number">4.</span> <span class="toc-text">OpenBSC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBSC-GPRS"><span class="toc-number">5.</span> <span class="toc-text">OpenBSC GPRS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#completely-build-osmo-bsc-osmo-msc-osmo-sgsn-and-osmo-ggsn"><span class="toc-number">5.0.1.</span> <span class="toc-text">completely build osmo-bsc, osmo-msc, osmo-sgsn and osmo-ggsn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置文件"><span class="toc-number">5.0.2.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#运行"><span class="toc-number">5.0.3.</span> <span class="toc-text">运行</span></a></li></ol></li>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        基于LimeSDR的GSM网络搭建
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">jsmhny's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-07-17T09:43:56.000Z" itemprop="datePublished">2018-07-17</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>这篇是记录怎么搭建简易GSM基站的，过程很复杂。搞了很长时间，现在慢慢整理一下。理一下思路。</p>
<p>首先是看到这个<code>http://osmocom.org/projects/osmobts/wiki/Wiki</code></p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>因为驱动的复杂性，必须从零开始。准备一个xubuntu16.04的全新虚拟机。<br>理论上的安装顺序是（UHD，SoapySDR,SoapyUHD,LimeSuite)<br>但是我不是这样装的，等会儿会提到。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先根据这个页面<code>https://osmocom.org/projects/osmotrx/wiki/LimeSDR_Build_From_Source</code><br>进行安装，但其中某些操作要改变，否则会出问题。</p>
<h4 id="LimeSuite-UHD-SoapyUHD-依赖"><a href="#LimeSuite-UHD-SoapyUHD-依赖" class="headerlink" title="LimeSuite UHD SoapyUHD 依赖"></a>LimeSuite UHD SoapyUHD 依赖</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository -y ppa:myriadrf/drivers</span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">#install core library and build dependencies</span><br><span class="line">sudo apt-get install git g++ cmake libsqlite3-dev </span><br><span class="line"></span><br><span class="line">#install hardware support dependencies</span><br><span class="line">sudo apt-get install libsoapysdr-dev libi2c-dev libusb-1.0-0-dev gnuplot</span><br><span class="line"></span><br><span class="line">#install graphics dependencies</span><br><span class="line">sudo apt-get install libwxgtk3.0-dev freeglut3-dev</span><br></pre></td></tr></table></figure>
<h4 id="Install-LimeSuite"><a href="#Install-LimeSuite" class="headerlink" title="Install LimeSuite"></a>Install LimeSuite</h4><p>这里出现问题，不能安装最新版的LimeSuite以及硬件驱动。否则会出问题，类似于这样<code>osmo-trx: symbol lookup error: osmo-trx: undefined symbol: _ZN3uhd3msg16register_handlerERKPFvNS0_6type_tERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEE</code><br>原因是新版的驱动将device name 从 STREAM 变成了 FX3 所导致的问题。<br>解决办法是下载旧版本的LimeSuite,进行安装，更新成旧版本的驱动。<br>我就从github找到了17.12版本，进行安装。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd LimeSuite</span><br><span class="line">mkdir builddir &amp;&amp; cd builddir</span><br><span class="line">cmake ../</span><br><span class="line">make -j4</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd LimeSuite/udev-rules</span><br><span class="line">sudo sh ./install.sh</span><br></pre></td></tr></table></figure></p>
<h4 id="Install-UHD"><a href="#Install-UHD" class="headerlink" title="Install UHD"></a>Install UHD</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install git swig cmake doxygen build-essential libboost-all-dev libtool libusb-1.0-0 libusb-1.0-0-dev libudev-dev libncurses5-dev libfftw3-bin libfftw3-dev libfftw3-doc libcppunit-1.13-0v5 libcppunit-dev libcppunit-doc ncurses-bin cpufrequtils python-numpy python-numpy-doc python-numpy-dbg python-scipy python-docutils qt4-bin-dbg qt4-default qt4-doc libqt4-dev libqt4-dev-bin python-qt4 python-qt4-dbg python-qt4-dev python-qt4-doc python-qt4-doc libqwt6abi1 libfftw3-bin libfftw3-dev libfftw3-doc ncurses-bin libncurses5 libncurses5-dev libncurses5-dbg libfontconfig1-dev libxrender-dev libpulse-dev swig g++ automake autoconf libtool python-dev libfftw3-dev libcppunit-dev libboost-all-dev libusb-dev libusb-1.0-0-dev fort77 libsdl1.2-dev python-wxgtk3.0 git-core libqt4-dev python-numpy ccache python-opengl libgsl-dev python-cheetah python-mako python-lxml doxygen qt4-default qt4-dev-tools libusb-1.0-0-dev libqwt5-qt4-dev libqwtplot3d-qt4-dev pyqt4-dev-tools python-qwt5-qt4 cmake git-core wget libxi-dev gtk2-engines-pixbuf r-base-dev python-tk liborc-0.4-0 liborc-0.4-dev libasound2-dev python-gtk2 libzmq-dev libzmq1 python-requests python-sphinx libcomedi-dev python-zmq</span><br><span class="line"></span><br><span class="line">git clone https://github.com/EttusResearch/uhd</span><br><span class="line">cd uhd</span><br><span class="line"></span><br><span class="line">git tag -l</span><br><span class="line">...</span><br><span class="line">release_003_009_004</span><br><span class="line">release_003_009_005</span><br><span class="line">release_003_010_000_000</span><br><span class="line"># Example: For UHD 3.10.000.000: </span><br><span class="line">  git checkout release_003_010_000_000 (get the latest if fine)</span><br><span class="line"></span><br><span class="line">cd host</span><br><span class="line">mkdir build</span><br><span class="line">cd build </span><br><span class="line">cmake ../</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">export LD_LIBRARY_PATH=/usr/local/lib</span><br></pre></td></tr></table></figure>
<h4 id="Install-SoapySDR-and-SoapyUHD"><a href="#Install-SoapySDR-and-SoapyUHD" class="headerlink" title="Install SoapySDR and SoapyUHD"></a>Install SoapySDR and SoapyUHD</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pothosware/SoapySDR.git</span><br><span class="line">cd SoapySDR</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">git clone https://github.com/pothosware/SoapyUHD</span><br><span class="line">cd SoapyUHD</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<p>到这里之后，运行<code>uhd_find_devices</code>是找不到设备的，是因为我们安装顺序的关系，这时候重新安装一次LimeSuite即可。主要要更新固件，方法是打开LimeSuiteGUI-Modules-Programming-Program.</p>
<h4 id="Install-libosmocore"><a href="#Install-libosmocore" class="headerlink" title="Install libosmocore"></a>Install libosmocore</h4><p>参考：<code>https://osmocom.org/projects/libosmocore/wiki/Libosmocore</code><br>这个比较坑<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libtool libtalloc-dev shtool autoconf automake git-core pkg-config make gcc</span><br><span class="line">sudo apt-get install libpcsclite-dev</span><br></pre></td></tr></table></figure></p>
<p>这里直接./configure可能会报错，需要安装<code>libgnutls-dev</code>.apt install 即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone git://git.osmocom.org/libosmocore.git</span><br><span class="line">cd libosmocore/</span><br><span class="line">autoreconf -i</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig -i</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure></p>
<h4 id="Install-osmo-trx"><a href="#Install-osmo-trx" class="headerlink" title="Install osmo-trx"></a>Install osmo-trx</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/osmocom/osmo-trx</span><br><span class="line">cd osmo-trx</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<p>这里一定要通过源码编译安装，如果通过apt安装也会报错。<br>错误大概如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">terminate called after throwing an instance of &apos;std::bad_alloc&apos;</span><br><span class="line">  what():  std::bad_alloc</span><br><span class="line">Aborted (core dumped)</span><br></pre></td></tr></table></figure></p>
<h4 id="Install-osmo-nitb"><a href="#Install-osmo-nitb" class="headerlink" title="Install osmo-nitb"></a>Install osmo-nitb</h4><p>参考：<code>https://osmocom.org/projects/cellular-infrastructure/wiki/Nightly_Builds</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wget --https-only https://download.opensuse.org/repositories/network:/osmocom:/nightly/xUbuntu_16.04/Release.key</span><br><span class="line">sha256sum Release.key</span><br><span class="line"># verify the SHA256 sum with the one on https://osmocom.org/projects/cellular-infrastructure/wiki/Nightly_Builds</span><br><span class="line">sudo apt-key add Release.key</span><br><span class="line">sudo su</span><br><span class="line">echo &quot;deb http://download.opensuse.org/repositories/network:/osmocom:/nightly/xUbuntu_16.04/ ./&quot; &gt; /etc/apt/sources.list.d/osmocom-nightly.list</span><br><span class="line">exit</span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install osmocom-nitb osmo-bts-trx</span><br></pre></td></tr></table></figure></p>
<h2 id="OpenBTS"><a href="#OpenBTS" class="headerlink" title="OpenBTS"></a>OpenBTS</h2><p>安装到这里之后其实有两种选择，一种是OpenBTS,一种是OpenBSC。<br>OsmoTRX和OpenBTS是兼容的，可以实现语音和SMS服务，但是GPRS是不支持的。<br>理论上OsmoTRX支持osmoPCU和osmoBTS的GPRS功能。</p>
<h4 id="安装OpenBTS"><a href="#安装OpenBTS" class="headerlink" title="安装OpenBTS"></a>安装OpenBTS</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir OpenBTS  //新建OpenBTS文件夹</span><br><span class="line">cd OpenBTS  //进入该文件夹</span><br><span class="line">git clone https://github.com/RangeNetworks/dev.git</span><br><span class="line">cd dev</span><br><span class="line">./clone.sh  //克隆代码</span><br><span class="line">./switchto.sh master  //切到master分支</span><br><span class="line">./build.sh B200   //构建USRP B200设备支持</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install software-properties-common python-software-properties</span><br><span class="line">sudo add-apt-repository ppa:chris-lea/zeromq</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>进入 <code>OpenBTS/dev/BUILDS/日期&#39;文件夹把所有deb都通过</code>sudo dpkg -i<code>安装
有问题就用</code>sudo apt-get install -f`</p>
<h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><p>启动osmo-trx,这里有一个问题，我的2.4G无线鼠标会跟USB3.0有干扰，导致会出现一些问题。<br><code>sudo osmo-trx-uhd -s 4 -c 1 -e -l INFO -f</code></p>
<ul>
<li><p>加载数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd dev/openbts/apps</span><br><span class="line">sudo sqlite3 -init OpenBTS.example.sql /etc/OpenBTS/OpenBTS.db &quot;.quit&quot;</span><br><span class="line"></span><br><span class="line">cd dev/subscriberRegistry/apps</span><br><span class="line">sudo sqlite3 -init sipauthserve.example.sql /etc/OpenBTS/sipauthserve.db &quot;.quit&quot;</span><br><span class="line"></span><br><span class="line">cd dev/smqueue/smqueue</span><br><span class="line">sudo sqlite3 -init smqueue.example.sql /etc/OpenBTS/smqueue.db &quot;.quit&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置asterisk</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">在/etc/asterisk/目录中需要修改sip.conf、extensions.conf 具体方法：将手机的IMSI国际用户识别码和分配的号码登记数据asterisk中，也就是将数据写入sip.conf、extensions.conf两个配置文件。</span><br><span class="line"></span><br><span class="line">SIP.CONF:</span><br><span class="line"></span><br><span class="line">[IMSI46001658*****19]</span><br><span class="line">callerid=2000003</span><br><span class="line">canreinvite=no</span><br><span class="line">type=friend</span><br><span class="line">allow=gsm</span><br><span class="line">context=sip-external</span><br><span class="line">host=dynamic</span><br><span class="line">dtmfmode=info</span><br><span class="line"></span><br><span class="line">[IMSI41004030*****62]</span><br><span class="line">callerid=2000004</span><br><span class="line">canreinvite=no</span><br><span class="line">type=friend</span><br><span class="line">allow=gsm</span><br><span class="line">context=sip-external</span><br><span class="line">host=dynamic</span><br><span class="line">dtmfmode=info</span><br><span class="line">callerid=2000003,表示将IMSI为46001658*****19的手机分配号码2000003；</span><br><span class="line"></span><br><span class="line">canreinvite=no，表示被呼叫的手机一旦建立连接后OpenBTS将不再发送重新邀请的指令；</span><br><span class="line"></span><br><span class="line">context=sip-external，表示允许外部未分配号码的匿名电话呼入。</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动基站</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd dev/openbts/apps/</span><br><span class="line">sudo ./OpenBTS</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动短信服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd dev/smqueue/smqueue</span><br><span class="line">sudo ./smqueue</span><br></pre></td></tr></table></figure>
</li>
<li><p>启用鉴权服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd dev/subscriberRegistry/apps</span><br><span class="line">sudo ./sipauthserve</span><br></pre></td></tr></table></figure>
</li>
<li><p>asterisk</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo asterisk -vvvc</span><br><span class="line">sudo asterisk -r</span><br></pre></td></tr></table></figure>
</li>
<li><p>允许任意机器接入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OpenBTS&gt; config Control.LUR.OpenRegistration .*</span><br><span class="line">Control.LUR.OpenRegistration changed from &quot;&quot; to &quot;.*&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置天线功率</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OpenBTS&gt; devconfig GSM.Radio.RxGain 18</span><br><span class="line">GSM.Radio.RxGain changed from &quot;50&quot; to &quot;18&quot;</span><br><span class="line">GSM.Radio.RxGain is static; change takes effect on restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置基站频段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OpenBTS&gt; config GSM.Radio.Band 900</span><br><span class="line">GSM.Radio.Band changed from &quot;850&quot; to &quot;900&quot;</span><br><span class="line">GSM.Radio.Band is static; change takes effect on restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置欢迎短信</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config Control.LUR.NormalRegistration.Message Welcome to BTS 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>其他</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">设置基站名：</span><br><span class="line">config GSM.Identity.ShortName GroundControl</span><br><span class="line">将基站设置为测试网络：</span><br><span class="line">config Identity config GSM.Identity.MCC 001</span><br><span class="line">将基站设置为国内： MCC460 为中国</span><br><span class="line">config GSM.Identity.MCC 460</span><br><span class="line">设置运营商为联 * 通：</span><br><span class="line">config GSM.Identity.MNC 01 </span><br><span class="line">设置运营商为移 * 动：</span><br><span class="line">config GSM.Identity.MNC 00 </span><br><span class="line">设置ARFCN、LAC、BCC</span><br><span class="line">网络色码，NCC，一般用于标识运营商；基站色码，BCC，区分同一运营商下的相同BCCH的不同基站。</span><br><span class="line"></span><br><span class="line">一般采用BCCH频点和BSIC来联合标识小区，BSIC=NCC+BCC。在TD和WCDMA里，存在PLMN，PLMN=MCC+MNC，其中MCC为移动国家码，MNC为移动网络码标识运营商。</span><br><span class="line"></span><br><span class="line">基站切换的时候,主要是通过CI、BCCHBSIC等信息寻找目标小区,当同时检测到邻区列表里出现同BCCH同扰码组的小区时,容易出现切换失败。</span><br><span class="line">OpenBTS&gt; config GSM.Radio.C0 168</span><br><span class="line">GSM.Radio.C0 changed from &quot;151&quot; to &quot;168&quot;</span><br><span class="line">GSM.Radio.C0 is static; change takes effect on restart</span><br><span class="line">OpenBTS&gt; config GSM.Identity.BSIC.BCC 3</span><br><span class="line">GSM.Identity.BSIC.BCC changed from &quot;2&quot; to &quot;3&quot;</span><br><span class="line">OpenBTS&gt; config GSM.Identity.LAC 1001</span><br><span class="line">GSM.Identity.LAC changed from &quot;1000&quot; to &quot;1001&quot;</span><br><span class="line">OpenBTS&gt; config GSM.Identity.CI 11</span><br><span class="line">GSM.Identity.CI changed from &quot;10&quot; to &quot;11&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看已加入基站的设备<br><code>OpenBTS&gt; tmsis</code></p>
</li>
<li><p>发送短信<br><code>sendsms IMSI 号码 内容</code></p>
</li>
</ul>
<h2 id="OpenBSC"><a href="#OpenBSC" class="headerlink" title="OpenBSC"></a>OpenBSC</h2><p>然后看选择OpenBSC的折腾过程，首先可以先搞定通话和短信服务。<br>osmonitb在之前装好了，那么可以通过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo osmo-trx-uhd -e # root needed for thread options set by the process</span><br><span class="line">osmo-nitb -c ./openbsc.cfg # change the path to your openbsc.cfg file</span><br><span class="line">osmo-bts-trx -c ./osmo-bts.cfg</span><br></pre></td></tr></table></figure></p>
<p>跑起来</p>
<p>需要改配置文件，我现在把成功的配置文件记录一下。<br>osmo-trx.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 1</span><br><span class="line">  logging timestamp 1</span><br><span class="line">  logging level all info</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">trx</span><br><span class="line"> bind-ip 127.0.0.1</span><br><span class="line"> remote-ip 127.0.0.1</span><br><span class="line"> base-port 5700</span><br><span class="line"> egprs disable</span><br><span class="line"> tx-sps 4</span><br><span class="line"> rx-sps 4</span><br><span class="line"> chan 0</span><br><span class="line">  tx-path BAND1</span><br><span class="line">  rx-path LNAW</span><br></pre></td></tr></table></figure></p>
<p>openbsc.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! OpenBSC configuration saved from vty</span><br><span class="line">!   !</span><br><span class="line">password foo</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">e1_input</span><br><span class="line"> e1_line 0 driver ipa</span><br><span class="line">network</span><br><span class="line"> network country code 460</span><br><span class="line"> mobile network code 10</span><br><span class="line"> short name OpenBSC</span><br><span class="line"> long name OpenBSC</span><br><span class="line"> auth policy accept-all</span><br><span class="line"> location updating reject cause 13</span><br><span class="line"> encryption a5 0</span><br><span class="line"> neci 1</span><br><span class="line"> rrlp mode none</span><br><span class="line"> mm info 1</span><br><span class="line"> handover 0</span><br><span class="line"> handover window rxlev averaging 10</span><br><span class="line"> handover window rxqual averaging 1</span><br><span class="line"> handover window rxlev neighbor averaging 10</span><br><span class="line"> handover power budget interval 6</span><br><span class="line"> handover power budget hysteresis 3</span><br><span class="line"> handover maximum distance 9999</span><br><span class="line"> bts 0</span><br><span class="line">  type sysmobts</span><br><span class="line">  band GSM900</span><br><span class="line">  cell_identity 0</span><br><span class="line">  location_area_code 1</span><br><span class="line">  training_sequence_code 7</span><br><span class="line">  base_station_id_code 63</span><br><span class="line">  ms max power 15</span><br><span class="line">  cell reselection hysteresis 4</span><br><span class="line">  rxlev access min 0</span><br><span class="line">  channel allocator ascending</span><br><span class="line">  rach tx integer 9</span><br><span class="line">  rach max transmission 7</span><br><span class="line">  ip.access unit_id 1801 0</span><br><span class="line">  oml ip.access stream_id 255 line 0</span><br><span class="line">  gprs mode gprs</span><br><span class="line">  gprs routing area 0</span><br><span class="line">  gprs cell bvci 2</span><br><span class="line">  gprs nsei 101</span><br><span class="line">  gprs nsvc 0 nsvci 101</span><br><span class="line">  gprs nsvc 0 local udp port 23000</span><br><span class="line">  gprs nsvc 0 remote udp port 23000</span><br><span class="line">  gprs nsvc 0 remote ip 10.10.10.150</span><br><span class="line">  trx 0</span><br><span class="line">   rf_locked 0</span><br><span class="line">   arfcn 975</span><br><span class="line">   nominal power 23</span><br><span class="line">   max_power_red 20</span><br><span class="line">   rsl e1 tei 0</span><br><span class="line">   timeslot 0</span><br><span class="line">    phys_chan_config CCCH+SDCCH4</span><br><span class="line">   timeslot 1</span><br><span class="line">    phys_chan_config SDCCH8</span><br><span class="line">   timeslot 2</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">   timeslot 3</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">   timeslot 4</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">   timeslot 5</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">   timeslot 6</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">   timeslot 7</span><br><span class="line">    phys_chan_config TCH/F</span><br></pre></td></tr></table></figure></p>
<p>osmo-bts.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! OsmoBTS configuration saved from vty</span><br><span class="line">!!</span><br><span class="line">!</span><br><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 0</span><br><span class="line">  logging timestamp 0</span><br><span class="line">  logging level rsl notice</span><br><span class="line">  logging level rll notice</span><br><span class="line">  logging level rr notice</span><br><span class="line">  logging level meas error</span><br><span class="line">  logging level pag error</span><br><span class="line">  logging level l1c error</span><br><span class="line">  logging level l1p error</span><br><span class="line">  logging level dsp error</span><br><span class="line">  logging level pcu notice</span><br><span class="line">  logging level ho notice</span><br><span class="line">  logging level trx notice</span><br><span class="line">  logging level loop notice</span><br><span class="line">  logging level abis error</span><br><span class="line">  logging level rtp notice</span><br><span class="line">  logging level lglobal notice</span><br><span class="line">  logging level llapd notice</span><br><span class="line">  logging level lsms notice</span><br><span class="line">  logging level lctrl notice</span><br><span class="line">  logging level lstats notice</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">e1_input</span><br><span class="line"> e1_line 0 driver ipa</span><br><span class="line"> e1_line 0 port 0</span><br><span class="line"> no e1_line 0 keepalive</span><br><span class="line">phy 0</span><br><span class="line"> osmotrx ip 127.0.0.1</span><br><span class="line"> osmotrx fn-advance 20</span><br><span class="line"> osmotrx rts-advance 5</span><br><span class="line"> instance 0</span><br><span class="line">bts 0</span><br><span class="line"> band GSM900</span><br><span class="line"> ipa unit-id 1801 0</span><br><span class="line"> oml remote-ip 127.0.0.1</span><br><span class="line"> rtp jitter-buffer 100</span><br><span class="line"> paging queue-size 200</span><br><span class="line"> paging lifetime 0</span><br><span class="line"> uplink-power-target -75</span><br><span class="line"> gsmtap-sapi ccch</span><br><span class="line"> gsmtap-sapi pdtch</span><br><span class="line"> min-qual-rach 50</span><br><span class="line"> min-qual-norm -5</span><br><span class="line"> trx 0</span><br><span class="line">  power-ramp max-initial 23000 mdBm</span><br><span class="line">  power-ramp step-size 2000 mdB</span><br><span class="line">  power-ramp step-interval 1</span><br><span class="line">  ms-power-control dsp</span><br><span class="line">  phy 0 instance 0</span><br></pre></td></tr></table></figure></p>
<h2 id="OpenBSC-GPRS"><a href="#OpenBSC-GPRS" class="headerlink" title="OpenBSC GPRS"></a>OpenBSC GPRS</h2><p>参考：<br><code>https://osmocom.org/projects/cellular-infrastructure/wiki/OpenBSC_GPRS</code><br><code>https://github.com/cswiger/osmocom_cfg1</code></p>
<p>安装依赖<br><code>apt install libdbi0-dev libdbd-sqlite3 libtool autoconf git-core pkg-config make libortp-dev</code></p>
<p>需要安装<br>openggsn<br>libosmocore<br>libosmo-abis<br>libosmo-netif<br>openbsc<br>osmo-pcu</p>
<h4 id="completely-build-osmo-bsc-osmo-msc-osmo-sgsn-and-osmo-ggsn"><a href="#completely-build-osmo-bsc-osmo-msc-osmo-sgsn-and-osmo-ggsn" class="headerlink" title="completely build osmo-bsc, osmo-msc, osmo-sgsn and osmo-ggsn"></a>completely build osmo-bsc, osmo-msc, osmo-sgsn and osmo-ggsn</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libosmocore</span><br><span class="line">cd libosmocore</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libosmo-abis</span><br><span class="line">cd libosmo-abis</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libosmo-netif</span><br><span class="line">cd libosmo-netif</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libosmo-sccp</span><br><span class="line">cd libosmo-sccp</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libsmpp34</span><br><span class="line">cd libsmpp34</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/osmo-mgw</span><br><span class="line">cd osmo-mgw</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/libasn1c</span><br><span class="line">cd libasn1c</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/osmo-iuh</span><br><span class="line">cd osmo-iuh</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/osmo-msc</span><br><span class="line">cd osmo-msc</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure --enable-iu</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/osmo-ggsn</span><br><span class="line">cd osmo-ggsn</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br><span class="line"></span><br><span class="line">cd $osmo_src</span><br><span class="line">git clone git://git.osmocom.org/osmo-sgsn</span><br><span class="line">cd osmo-sgsn</span><br><span class="line">autoreconf -fi</span><br><span class="line">./configure --enable-iu</span><br><span class="line">make -j5</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>openbsc.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! OpenBSC (1.0.0.14-98a2ba) configuration saved from vty</span><br><span class="line">!!</span><br><span class="line">password foo</span><br><span class="line">!</span><br><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 0</span><br><span class="line">  logging timestamp 0</span><br><span class="line">  logging print file 1</span><br><span class="line">  logging level all everything</span><br><span class="line">  logging level rll notice</span><br><span class="line">  logging level cc notice</span><br><span class="line">  logging level mm notice</span><br><span class="line">  logging level rr notice</span><br><span class="line">  logging level rsl notice</span><br><span class="line">  logging level nm info</span><br><span class="line">  logging level mncc notice</span><br><span class="line">  logging level pag notice</span><br><span class="line">  logging level meas notice</span><br><span class="line">  logging level sccp notice</span><br><span class="line">  logging level msc notice</span><br><span class="line">  logging level mgcp notice</span><br><span class="line">  logging level ho notice</span><br><span class="line">  logging level db notice</span><br><span class="line">  logging level ref notice</span><br><span class="line">  logging level gprs debug</span><br><span class="line">  logging level ns info</span><br><span class="line">  logging level bssgp debug</span><br><span class="line">  logging level llc debug</span><br><span class="line">  logging level sndcp debug</span><br><span class="line">  logging level nat notice</span><br><span class="line">  logging level ctrl notice</span><br><span class="line">  logging level smpp debug</span><br><span class="line">  logging level filter debug</span><br><span class="line">  logging level ranap debug</span><br><span class="line">  logging level sua debug</span><br><span class="line">  logging level pcu debug</span><br><span class="line">  logging level lglobal notice</span><br><span class="line">  logging level llapd notice</span><br><span class="line">  logging level linp notice</span><br><span class="line">  logging level lmux notice</span><br><span class="line">  logging level lmi notice</span><br><span class="line">  logging level lmib notice</span><br><span class="line">  logging level lsms notice</span><br><span class="line">  logging level lctrl notice</span><br><span class="line">  logging level lgtp notice</span><br><span class="line">  logging level lstats notice</span><br><span class="line">  logging level lgsup notice</span><br><span class="line">  logging level loap notice</span><br><span class="line">  logging level lss7 notice</span><br><span class="line">  logging level lsccp notice</span><br><span class="line">  logging level lsua notice</span><br><span class="line">  logging level lm3ua notice</span><br><span class="line">  logging level lmgcp notice</span><br><span class="line">!</span><br><span class="line">stats interval 5</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">e1_input</span><br><span class="line"> e1_line 0 driver ipa</span><br><span class="line"> e1_line 0 port 0</span><br><span class="line"> no e1_line 0 keepalive</span><br><span class="line">network</span><br><span class="line"> network country code 460</span><br><span class="line"> mobile network code 10</span><br><span class="line"> short name OpenBSC</span><br><span class="line"> long name OpenBSC</span><br><span class="line"> auth policy accept-all</span><br><span class="line"> authorized-regexp .*</span><br><span class="line"> location updating reject cause 13</span><br><span class="line"> encryption a5 0</span><br><span class="line"> neci 1</span><br><span class="line"> paging any use tch 0</span><br><span class="line"> rrlp mode none</span><br><span class="line"> mm info 1</span><br><span class="line"> handover 0</span><br><span class="line"> handover window rxlev averaging 10</span><br><span class="line"> handover window rxqual averaging 1</span><br><span class="line"> handover window rxlev neighbor averaging 10</span><br><span class="line"> handover power budget interval 6</span><br><span class="line"> handover power budget hysteresis 3</span><br><span class="line"> handover maximum distance 9999</span><br><span class="line"> dyn_ts_allow_tch_f 0</span><br><span class="line"> subscriber-keep-in-ram 0</span><br><span class="line"> bts 0</span><br><span class="line">  type sysmobts</span><br><span class="line">  band GSM900</span><br><span class="line">  cell_identity 0</span><br><span class="line">  location_area_code 1</span><br><span class="line">  base_station_id_code 63</span><br><span class="line">  ms max power 35</span><br><span class="line">  cell reselection hysteresis 4</span><br><span class="line">  rxlev access min 0</span><br><span class="line">  periodic location update 30</span><br><span class="line">  radio-link-timeout 32</span><br><span class="line">  channel allocator ascending</span><br><span class="line">  rach tx integer 9</span><br><span class="line">  rach max transmission 7</span><br><span class="line">  channel-descrption attach 1</span><br><span class="line">  channel-descrption bs-pa-mfrms 5</span><br><span class="line">  channel-descrption bs-ag-blks-res 1</span><br><span class="line">  early-classmark-sending forbidden</span><br><span class="line">  early-classmark-sending-3g allowed</span><br><span class="line">  ip.access unit_id 1801 0</span><br><span class="line">  oml ip.access stream_id 255 line 0</span><br><span class="line">  neighbor-list mode automatic</span><br><span class="line">  codec-support fr efr amr</span><br><span class="line">  amr tch-f modes 2</span><br><span class="line">  amr tch-f start-mode 1</span><br><span class="line">  gprs mode gprs</span><br><span class="line">  gprs routing area 1</span><br><span class="line">  gprs cell bvci 1234</span><br><span class="line">  gprs nsei 1234</span><br><span class="line">  gprs nsvc 0 nsvci 1234</span><br><span class="line">  gprs nsvc 0 local udp port 23001</span><br><span class="line">  gprs nsvc 0 remote udp port 23000</span><br><span class="line">  gprs nsvc 0 remote ip 127.0.0.1</span><br><span class="line">  no force-combined-si</span><br><span class="line">  trx 0</span><br><span class="line">   rf_locked 0</span><br><span class="line">   arfcn 975</span><br><span class="line">   nominal power 13</span><br><span class="line">   max_power_red 0</span><br><span class="line">   rsl e1 tei 0</span><br><span class="line">   timeslot 0</span><br><span class="line">    phys_chan_config CCCH+SDCCH4</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 1</span><br><span class="line">    phys_chan_config SDCCH8</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 2</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 3</span><br><span class="line">    phys_chan_config TCH/F</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 4</span><br><span class="line">    phys_chan_config PDCH</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 5</span><br><span class="line">    phys_chan_config PDCH</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 6</span><br><span class="line">    phys_chan_config PDCH</span><br><span class="line">    hopping enabled 0</span><br><span class="line">   timeslot 7</span><br><span class="line">    phys_chan_config PDCH</span><br><span class="line">    hopping enabled 0</span><br><span class="line">mncc-int</span><br><span class="line"> default-codec tch-f fr</span><br><span class="line"> default-codec tch-h hr</span><br><span class="line">nitb</span><br><span class="line"> subscriber-create-on-demand</span><br><span class="line"> assign-tmsi</span><br></pre></td></tr></table></figure></p>
<p>osmo-bts.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! OsmoBTS () configuration saved from vty</span><br><span class="line">!!</span><br><span class="line">!</span><br><span class="line">log stderr</span><br><span class="line">  logging color 1</span><br><span class="line">  logging timestamp 0</span><br><span class="line">  logging level rsl notice</span><br><span class="line">  logging level oml notice</span><br><span class="line">  logging level rll notice</span><br><span class="line">  logging level rr notice</span><br><span class="line">  logging level meas error</span><br><span class="line">  logging level pag error</span><br><span class="line">  logging level l1c error</span><br><span class="line">  logging level l1p error</span><br><span class="line">  logging level dsp error</span><br><span class="line">  logging level abis error</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">phy 0</span><br><span class="line"> instance 0</span><br><span class="line">  osmotrx rx-gain 43</span><br><span class="line"> osmotrx ip local 127.0.0.1</span><br><span class="line"> osmotrx ip remote 127.0.0.1</span><br><span class="line">bts 0</span><br><span class="line"> band 900</span><br><span class="line"> ipa unit-id 1801 0</span><br><span class="line"> oml remote-ip 127.0.0.1</span><br><span class="line"> gsmtap-sapi ccch</span><br><span class="line"> gsmtap-sapi pdtch</span><br><span class="line"> trx 0</span><br><span class="line">  phy 0 instance 0</span><br></pre></td></tr></table></figure></p>
<p>osmo-ggsn.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! OpenGGSN (0.94.1-adac) configuration saved from vty</span><br><span class="line">!!</span><br><span class="line">!</span><br><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 0</span><br><span class="line">  logging timestamp 0</span><br><span class="line">  logging level ip info</span><br><span class="line">  logging level tun info</span><br><span class="line">  logging level ggsn info</span><br><span class="line">  logging level sgsn notice</span><br><span class="line">  logging level icmp6 notice</span><br><span class="line">  logging level lglobal notice</span><br><span class="line">  logging level llapd notice</span><br><span class="line">  logging level linp notice</span><br><span class="line">  logging level lmux notice</span><br><span class="line">  logging level lmi notice</span><br><span class="line">  logging level lmib notice</span><br><span class="line">  logging level lsms notice</span><br><span class="line">  logging level lctrl notice</span><br><span class="line">  logging level lgtp info</span><br><span class="line">  logging level lstats notice</span><br><span class="line">  logging level lgsup notice</span><br><span class="line">  logging level loap notice</span><br><span class="line">  logging level lss7 notice</span><br><span class="line">  logging level lsccp notice</span><br><span class="line">  logging level lsua notice</span><br><span class="line">  logging level lm3ua notice</span><br><span class="line">  logging level lmgcp notice</span><br><span class="line">!</span><br><span class="line">stats interval 5</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">ggsn ggsn0</span><br><span class="line"> gtp state-dir /tmp</span><br><span class="line"> gtp bind-ip 127.0.0.6</span><br><span class="line"> apn internet</span><br><span class="line">  gtpu-mode tun</span><br><span class="line">  tun-device tun4</span><br><span class="line">  type-support v4</span><br><span class="line">  ip prefix dynamic 176.16.222.0/24</span><br><span class="line">!  ip prefix dynamic 192.168.7.0/24</span><br><span class="line">  ip dns 0 114.114.114.114</span><br><span class="line">  ip dns 1 8.8.8.8</span><br><span class="line">  ip ifconfig 176.16.222.0/24</span><br><span class="line">!  ip ifconfig 192.168.7.0/24</span><br><span class="line">  no shutdown</span><br><span class="line"> apn inet6</span><br><span class="line">  gtpu-mode tun</span><br><span class="line">  tun-device tun6</span><br><span class="line">  type-support v6</span><br><span class="line">  ipv6 prefix dynamic 2001:780:44:2000:0:0:0:0/56</span><br><span class="line">  ipv6 dns 0 2001:4860:4860::8888</span><br><span class="line">  ipv6 dns 1 2001:4860:4860::8844</span><br><span class="line">  ipv6 ifconfig 2001:780:44:2000:0:0:0:0/56</span><br><span class="line">  no shutdown</span><br><span class="line"> apn inet46</span><br><span class="line">  gtpu-mode tun</span><br><span class="line">  tun-device tun46</span><br><span class="line">  type-support v4v6</span><br><span class="line">  ip prefix dynamic 176.16.46.0/24</span><br><span class="line">  ip dns 0 114.114.114.114</span><br><span class="line">  ip dns 1 8.8.8.8</span><br><span class="line">  ip ifconfig 176.16.46.0/24</span><br><span class="line">  ipv6 prefix dynamic 2001:780:44:2100:0:0:0:0/56</span><br><span class="line">  ipv6 dns 0 2001:4860:4860::8888</span><br><span class="line">  ipv6 dns 1 2001:4860:4860::8844</span><br><span class="line">  ipv6 ifconfig 2001:780:44:2100:0:0:0:0/56</span><br><span class="line">  no shutdown</span><br><span class="line"> default-apn internet</span><br><span class="line"> no shutdown ggsn</span><br></pre></td></tr></table></figure></p>
<p>osmo-pcu.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! Osmo-PCU (0.4.0.83-5b22) configuration saved from vty</span><br><span class="line">!!</span><br><span class="line">!</span><br><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 0</span><br><span class="line">  logging timestamp 0</span><br><span class="line">  logging print file 1</span><br><span class="line">  logging level all everything</span><br><span class="line">  logging level csn1 info</span><br><span class="line">  logging level l1if info</span><br><span class="line">  logging level rlcmac notice</span><br><span class="line">  logging level rlcmacdata notice</span><br><span class="line">  logging level rlcmacdl notice</span><br><span class="line">  logging level rlcmacul notice</span><br><span class="line">  logging level rlcmacsched notice</span><br><span class="line">  logging level rlcmacmeas info</span><br><span class="line">  logging level tbf info</span><br><span class="line">  logging level tbfdl info</span><br><span class="line">  logging level tbful info</span><br><span class="line">  logging level ns info</span><br><span class="line">  logging level bssgp info</span><br><span class="line">  logging level pcu notice</span><br><span class="line">  logging level lglobal notice</span><br><span class="line">  logging level llapd notice</span><br><span class="line">  logging level linp notice</span><br><span class="line">  logging level lmux notice</span><br><span class="line">  logging level lmi notice</span><br><span class="line">  logging level lmib notice</span><br><span class="line">  logging level lsms notice</span><br><span class="line">  logging level lctrl notice</span><br><span class="line">  logging level lgtp notice</span><br><span class="line">  logging level lstats notice</span><br><span class="line">  logging level lgsup notice</span><br><span class="line">  logging level loap notice</span><br><span class="line">  logging level lss7 notice</span><br><span class="line">  logging level lsccp notice</span><br><span class="line">  logging level lsua notice</span><br><span class="line">  logging level lm3ua notice</span><br><span class="line">  logging level lmgcp notice</span><br><span class="line">!</span><br><span class="line">stats interval 5</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">pcu</span><br><span class="line"> flow-control-interval 10</span><br><span class="line"> cs 2</span><br><span class="line"> cs max 4</span><br><span class="line"> cs threshold 10 33</span><br><span class="line"> cs downgrade-threshold 200</span><br><span class="line"> cs link-quality-ranges cs1 6 cs2 5 8 cs3 7 13 cs4 12</span><br><span class="line"> mcs link-quality-ranges mcs1 6 mcs2 5 8 mcs3 7 13 mcs4 12 15 mcs5 14 17 mcs6 16 18 mcs7 17 20 mcs8 19 24 mcs9 23</span><br><span class="line"> mcs max 9</span><br><span class="line"> window-size 64 0</span><br><span class="line"> queue idle-ack-delay 10</span><br><span class="line"> queue codel</span><br><span class="line"> alloc-algorithm dynamic</span><br><span class="line"> alpha 0</span><br><span class="line"> gamma 0</span><br><span class="line"> dl-tbf-idle-time 2000</span><br></pre></td></tr></table></figure></p>
<p>osmo-sgsn.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">!</span><br><span class="line">! Osmocom SGSN configuration</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">sgsn</span><br><span class="line"> gtp local-ip 127.0.0.1</span><br><span class="line"> ggsn 0 remote-ip 127.0.0.6</span><br><span class="line"> ggsn 0 gtp-version 1</span><br><span class="line">! auth-policy closed</span><br><span class="line">! accept-all, closed, acl-only, remote</span><br><span class="line"> auth-policy accept-all</span><br><span class="line">! gsup remote-ip 127.0.0.1</span><br><span class="line">! gsup remote-port 4222</span><br><span class="line">!</span><br><span class="line">ns</span><br><span class="line"> timer tns-block 3</span><br><span class="line"> timer tns-block-retries 3</span><br><span class="line"> timer tns-reset 3</span><br><span class="line"> timer tns-reset-retries 3</span><br><span class="line"> timer tns-test 30</span><br><span class="line"> timer tns-alive 3</span><br><span class="line"> timer tns-alive-retries 10</span><br><span class="line"> encapsulation udp local-ip 127.0.0.1</span><br><span class="line"> encapsulation udp local-port 23000</span><br><span class="line"> encapsulation framerelay-gre enabled 0</span><br><span class="line">!</span><br><span class="line">bssgp</span><br><span class="line">!</span><br></pre></td></tr></table></figure></p>
<p>osmo-trx.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">log stderr</span><br><span class="line">  logging filter all 1</span><br><span class="line">  logging color 1</span><br><span class="line">  logging print category 1</span><br><span class="line">  logging timestamp 1</span><br><span class="line">  logging level all info</span><br><span class="line">!</span><br><span class="line">line vty</span><br><span class="line"> no login</span><br><span class="line">!</span><br><span class="line">trx</span><br><span class="line"> bind-ip 127.0.0.1</span><br><span class="line"> remote-ip 127.0.0.1</span><br><span class="line"> base-port 5700</span><br><span class="line"> egprs disable</span><br><span class="line"> tx-sps 4</span><br><span class="line"> rx-sps 4</span><br><span class="line"> chan 0</span><br><span class="line">  tx-path BAND1</span><br><span class="line">  rx-path LNAW</span><br></pre></td></tr></table></figure></p>
<h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw disable</span><br><span class="line">sudo iptables -F</span><br><span class="line">sudo iptables -t nat -F</span><br><span class="line">iptables -A POSTROUTING -t nat -o ens33 -j MASQUERADE &lt;-- change to your nic interface</span><br><span class="line">sudo -s</span><br><span class="line">echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<p>开多个终端跑起来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo osmo-trx -b4 -s4</span><br><span class="line">sudo osmo-nitb -m -P</span><br><span class="line">sudo osmo-pcu</span><br><span class="line">sudo osmo-sgsn</span><br><span class="line">sudo osmo-ggsn</span><br><span class="line">sudo osmo-bts-trx</span><br></pre></td></tr></table></figure></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#准备"><span class="toc-number">1.</span> <span class="toc-text">准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LimeSuite-UHD-SoapyUHD-依赖"><span class="toc-number">2.0.1.</span> <span class="toc-text">LimeSuite UHD SoapyUHD 依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-LimeSuite"><span class="toc-number">2.0.2.</span> <span class="toc-text">Install LimeSuite</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-UHD"><span class="toc-number">2.0.3.</span> <span class="toc-text">Install UHD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-SoapySDR-and-SoapyUHD"><span class="toc-number">2.0.4.</span> <span class="toc-text">Install SoapySDR and SoapyUHD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-libosmocore"><span class="toc-number">2.0.5.</span> <span class="toc-text">Install libosmocore</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-osmo-trx"><span class="toc-number">2.0.6.</span> <span class="toc-text">Install osmo-trx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-osmo-nitb"><span class="toc-number">2.0.7.</span> <span class="toc-text">Install osmo-nitb</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBTS"><span class="toc-number">3.</span> <span class="toc-text">OpenBTS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装OpenBTS"><span class="toc-number">3.0.1.</span> <span class="toc-text">安装OpenBTS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#启动"><span class="toc-number">3.0.2.</span> <span class="toc-text">启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBSC"><span class="toc-number">4.</span> <span class="toc-text">OpenBSC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenBSC-GPRS"><span class="toc-number">5.</span> <span class="toc-text">OpenBSC GPRS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#completely-build-osmo-bsc-osmo-msc-osmo-sgsn-and-osmo-ggsn"><span class="toc-number">5.0.1.</span> <span class="toc-text">completely build osmo-bsc, osmo-msc, osmo-sgsn and osmo-ggsn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置文件"><span class="toc-number">5.0.2.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#运行"><span class="toc-number">5.0.3.</span> <span class="toc-text">运行</span></a></li></ol></li>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&text=基于LimeSDR的GSM网络搭建"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&is_video=false&description=基于LimeSDR的GSM网络搭建"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=基于LimeSDR的GSM网络搭建&body=Check out this article: http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&title=基于LimeSDR的GSM网络搭建"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/07/17/基于LimeSDR的GSM网络搭建/&name=基于LimeSDR的GSM网络搭建&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 jsmhny
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


